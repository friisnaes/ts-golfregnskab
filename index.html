<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GUCCI Golf - √Örlig Turnering 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #2c5f2d 0%, #97bc62 100%);
            color: white;
            padding: 60px 40px;
            text-align: center;
        }

        h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .tagline {
            font-size: 1.3em;
            font-style: italic;
            opacity: 0.95;
        }

        .content {
            padding: 60px 40px;
        }

        h2 {
            color: #2c5f2d;
            font-size: 2.5em;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #97bc62;
        }

        /* Leaderboard */
        .leaderboard {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 50px;
        }

        .player-card {
            background: white;
            padding: 20px 30px;
            margin: 15px 0;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
            cursor: pointer;
        }

        .player-card:hover {
            transform: translateX(10px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .rank {
            font-size: 2em;
            font-weight: bold;
            color: #2c5f2d;
            min-width: 70px;
        }

        .player-info {
            flex: 1;
            padding: 0 20px;
        }

        .player-name {
            font-size: 1.6em;
            font-weight: 600;
            color: #2c3e50;
        }

        .player-stats {
            font-size: 0.9em;
            color: #7f8c8d;
            margin-top: 5px;
        }

        .total-points {
            font-size: 2.2em;
            color: #2c5f2d;
            font-weight: bold;
            min-width: 80px;
            text-align: right;
        }

        /* Rounds */
        .round {
            background: white;
            border-left: 5px solid #97bc62;
            padding: 30px;
            margin: 30px 0;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .round-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .round-title {
            font-size: 1.5em;
            font-weight: 600;
            color: #2c5f2d;
        }

        .round-date {
            color: #7f8c8d;
        }

        .course {
            color: #34495e;
            font-size: 1.1em;
            margin-bottom: 15px;
            font-style: italic;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #2c5f2d;
            border-bottom: 2px solid #dee2e6;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        tr:last-child td {
            border-bottom: none;
        }

        .placement {
            font-weight: bold;
            color: #2c5f2d;
            font-size: 1.2em;
        }

        .points {
            font-weight: bold;
            color: #27ae60;
            font-size: 1.3em;
        }

        footer {
            background: #34495e;
            color: white;
            text-align: center;
            padding: 30px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            font-size: 1.2em;
        }

        .error {
            background: #fee;
            border: 2px solid #e74c3c;
            color: #c0392b;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        /* Mobile */
        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }
            
            .content {
                padding: 30px 20px;
            }
            
            header {
                padding: 40px 20px;
            }
            
            .player-card {
                padding: 15px;
            }
            
            .rank {
                font-size: 1.5em;
                min-width: 50px;
            }
            
            .player-name {
                font-size: 1.2em;
            }
            
            .player-stats {
                font-size: 0.8em;
            }
            
            .total-points {
                font-size: 1.8em;
                min-width: 60px;
            }
            
            table {
                font-size: 0.9em;
            }
            
            th, td {
                padding: 10px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚õ≥ GUCCI Golf</h1>
            <p class="tagline">√Örlig Turnering 2026</p>
        </header>

        <div class="content">
            <!-- Leaderboard -->
            <section>
                <h2>üèÜ Samlet Stilling</h2>
                <p style="color: #7f8c8d; margin-bottom: 20px;">
                    Baseret p√• de 15 bedste runder for hver spiller
                </p>
                <div id="leaderboard" class="leaderboard">
                    <div class="loading">Henter data fra Google Sheets...</div>
                </div>
            </section>

            <!-- Rounds -->
            <section style="margin-top: 50px;">
                <h2>üìã Spillede Runder</h2>
                <div id="rounds">
                    <div class="loading">Henter runder...</div>
                </div>
            </section>
        </div>

        <footer>
            <p>&copy; 2026 GUCCI Golf | Hvor pr√¶cision m√∏der passion</p>
        </footer>
    </div>

    <script>
        // Configuration
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQJlVFWPaVOBOCro9c5dN3S0eba3oaL7OSPa5hokYI603LXOldRy7lNPLEEA3dQb2j2h9vruitqUwae/pub?gid=0&single=true&output=csv';
        const PLAYERS = ['Thomas', 'Henrik', 'Kim', 'Morten'];

        // Fetch and parse CSV from Google Sheets
        async function loadData() {
            try {
                const response = await fetch(SHEET_URL);
                const csvText = await response.text();
                
                console.log('CSV loaded, length:', csvText.length);
                console.log('First 300 chars:', csvText.substring(0, 300));
                
                return parseCSV(csvText);
            } catch (error) {
                console.error('Error loading data:', error);
                throw error;
            }
        }

        // Parse CSV to rounds
        function parseCSV(csvText) {
            const lines = csvText.trim().split('\n');
            const rounds = {};
            
            // Skip header (line 0)
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                const parts = line.split(',');
                if (parts.length < 8) continue;
                
                const roundID = parts[0];
                const courseName = parts[1];
                const date = parts[2];
                const playerName = parts[3];
                const score = parseInt(parts[4]);
                const points = parseFloat(parts[5]);
                const placement = parseInt(parts[6]);
                const tied = parts[7].toUpperCase() === 'TRUE';
                
                if (!rounds[roundID]) {
                    rounds[roundID] = {
                        id: roundID,
                        course: courseName,
                        date: date,
                        results: []
                    };
                }
                
                rounds[roundID].results.push({
                    player: playerName,
                    score: score,
                    points: points,
                    placement: placement,
                    tied: tied
                });
            }
            
            return Object.values(rounds);
        }

        // Calculate leaderboard
        function calculateLeaderboard(rounds) {
            const players = {};
            
            PLAYERS.forEach(name => {
                players[name] = {
                    name: name,
                    allPoints: [],
                    totalRounds: 0
                };
            });
            
            rounds.forEach(round => {
                round.results.forEach(result => {
                    if (players[result.player]) {
                        players[result.player].allPoints.push(result.points);
                        players[result.player].totalRounds++;
                    }
                });
            });
            
            // Calculate best 15
            Object.values(players).forEach(player => {
                player.allPoints.sort((a, b) => b - a);
                player.best15 = player.allPoints.slice(0, 15);
                player.total = player.best15.reduce((sum, p) => sum + p, 0);
            });
            
            // Sort by total
            return Object.values(players).sort((a, b) => b.total - a.total);
        }

        // Display leaderboard
        function displayLeaderboard(leaderboard) {
            const container = document.getElementById('leaderboard');
            const medals = ['ü•á', 'ü•à', 'ü•â', ''];
            
            let html = '';
            leaderboard.forEach((player, index) => {
                const medal = medals[index] || '';
                const avg = player.best15.length > 0 ? (player.total / player.best15.length).toFixed(1) : '0.0';
                
                html += `
                    <div class="player-card">
                        <div class="rank">#${index + 1} ${medal}</div>
                        <div class="player-info">
                            <div class="player-name">${player.name}</div>
                            <div class="player-stats">
                                ${player.totalRounds} runder | Bedste 15: ${player.best15.length} | Gns: ${avg} pt
                            </div>
                        </div>
                        <div class="total-points">${player.total.toFixed(1)}</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Display rounds
        function displayRounds(rounds) {
            const container = document.getElementById('rounds');
            
            if (rounds.length === 0) {
                container.innerHTML = '<div class="loading">Ingen runder endnu</div>';
                return;
            }
            
            // Sort by date (newest first)
            rounds.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            let html = '';
            rounds.forEach((round, index) => {
                const dateObj = new Date(round.date);
                const formattedDate = dateObj.toLocaleDateString('da-DK', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                html += `
                    <div class="round">
                        <div class="round-header">
                            <div class="round-title">Runde ${rounds.length - index}</div>
                            <div class="round-date">${formattedDate}</div>
                        </div>
                        <div class="course">üìç ${round.course}</div>
                        <table>
                            <thead>
                                <tr>
                                    <th>Placering</th>
                                    <th>Spiller</th>
                                    <th>Stableford</th>
                                    <th>Point</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                round.results.forEach(result => {
                    const place = result.tied ? `Delt ${result.placement}.` : `${result.placement}.`;
                    const pts = result.points % 1 === 0 ? result.points : result.points.toFixed(1);
                    
                    html += `
                        <tr>
                            <td class="placement">${place}</td>
                            <td>${result.player}</td>
                            <td>${result.score}</td>
                            <td class="points">${pts} pt</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // Initialize
        async function init() {
            try {
                const rounds = await loadData();
                console.log('Loaded rounds:', rounds.length);
                
                const leaderboard = calculateLeaderboard(rounds);
                console.log('Leaderboard:', leaderboard);
                
                displayLeaderboard(leaderboard);
                displayRounds(rounds);
                
            } catch (error) {
                console.error('Init error:', error);
                document.getElementById('leaderboard').innerHTML = 
                    '<div class="error">Fejl ved indl√¶sning af data. Tjek console for detaljer.</div>';
                document.getElementById('rounds').innerHTML = 
                    '<div class="error">Kunne ikke hente runder.</div>';
            }
        }

        // Start when page loads
        init();
    </script>
</body>
</html>
